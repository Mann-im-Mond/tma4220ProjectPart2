\section{Setting up the System}

\begin{frame}
\frametitle{Weak formulation}
\begin{equation*}
        \int\limits_{\Omega} \frac{\partial u}{\partial t} v = \int\limits_{\Omega} (\nabla(\alpha\nabla u)) v
\end{equation*}
\begin{equation*}
        \int\limits_{\Omega} \frac{\partial u}{\partial t} v = -\int\limits_{\Omega} \alpha(\nabla u) \cdot (\nabla v) + \int\limits_{\partial \Omega} \alpha v (\nabla u) \cdot \nu
\end{equation*}
\begin{equation*}
        \label{eqn::weakForm}
        \int\limits_{\Omega} \frac{\partial u}{\partial t} v = -\int\limits_{\Omega} \alpha(\nabla u) \cdot (\nabla v) +  \int\limits_{\partial\Omega^N} \alpha gv + \int\limits_{\partial \Omega^D} \alpha v (\nabla u) \cdot \nu.
\end{equation*}
\end{frame}

\begin{frame}
\frametitle{Fiscretized form}
\begin{equation*}
\begin{aligned}
        \int\limits_{\Omega} \sum_i \frac{\partial u_i}{\partial t} \phi_i \phi_j = &-\int\limits_{\Omega} \sum_i \alpha u_i(\nabla \phi_i) \cdot (\nabla \phi_j) \\
        &+ \int\limits_{\partial\Omega^N} \alpha g\phi_j \\
        &+ \int\limits_{\partial\Omega^D} \sum_i \alpha u_i (\nabla \phi_i) \cdot \nu \phi_j & \forall j
\end{aligned}
\end{equation*}
\end{frame}

\begin{frame}
\frametitle{Final discretized form}
\begin{align*}
        \int\limits_{\Omega} \sum_{i=1}^{n_D-1} \frac{\partial u_i}{\partial t} \phi_i \phi_j = &-\int\limits_{\Omega} \sum_{i=1}^{n_D-1} \alpha u_i(\nabla \phi_i) \cdot (\nabla \phi_j) \\
        &+ \int\limits_{\partial\Omega^N} \alpha g\phi_j \\
        &-        \int\limits_{\Omega} \sum_{i=n_D}^{n_h}\left( \dot{d}_i \phi_i \phi_j  + \alpha d_i(\nabla \phi_i) \cdot (\nabla \phi_j)\right)
         & \forall j,
\end{align*}
Index the nodes, so $n_D,\dots n_h$ are the Dirichlet nodes.\\
\begin{align*}
	\dot{d}_i:=&\frac{\partial u^D}{\partial t}(N_i)\\
	d_i:=&u^D(N_i)
\end{align*}
\end{frame}

\begin{frame}
\frametitle{ODE in Matrix form}
\begin{block}{}
\begin{equation*}
        M\frac{\partial u}{\partial t} = -A u + N - D.
\end{equation*}
\end{block}
\begin{align*}
        M_{ij} &:=\int\limits_{\Omega} \phi_i \phi_j \\
        A_{ij} &:=\int\limits_{\Omega} \alpha (\nabla \phi_i) \cdot (\nabla \phi_j) \\
        N_{j} &:=\int\limits_{\partial\Omega^N} \alpha g\phi_j \\
        D_{j} &:=\int\limits_{\Omega} \sum_{k=n_D}^{n_h}\left( \dot{d}_k \phi_k \phi_j  + \alpha d_k(\nabla \phi_k) \cdot (\nabla \phi_j)\right),
\end{align*}
\end{frame}